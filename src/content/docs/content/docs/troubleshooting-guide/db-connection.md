---
title: عیب‌یابی اتصالات پایگاه داده
redirect_from:
  - /docs/latest/troubleshooting-guide/datawarehouse
---

# عیب‌یابی اتصالات پایگاه داده

اگر نمی‌توانید به پایگاه داده خود متصل شوید، باید بفهمید که آیا مشکل با متابیس یا سرور پایگاه داده شما اتفاق می‌افتد.

اگر اتصال پایگاه داده شما موفق است، اما جداول در [Data Browser](https://www.metabase.com/learn/metabase-basics/querying-and-dashboards/data-browser) نمایش داده نمی‌شوند، به [عیب‌یابی جداول گم شده](./cant-see-tables.md) بروید.

## عیب‌یابی اتصالات به متابیس

1. به **Admin** > **Databases** بروید و پایگاه داده خود را انتخاب کنید تا تأیید کنید که اتصال شما تغییر یا حذف نشده است.

   - اگر متابیس هنوز همگام‌سازی با پایگاه داده شما را شروع نکرده است، روی **Sync database schema** کلیک کنید.

   - اگر متابیس زمان زیادی برای همگام‌سازی می‌گیرد، به [عیب‌یابی syncها و scanها](./sync-fingerprint-scan.md) بروید.

2. به **Admin** > **Tools** > **Logs** بروید تا بررسی کنید که آیا متابیس به دلیل [یک خطا](#common-database-connection-errors) در همگام‌سازی شکست خورده است.

   - اگر لاگ‌ها طاقت‌فرسا به نظر می‌رسند، [نحوهٔ خواندن لاگ‌های سرور](./server-logs.md) را بررسی کنید.

اگر به پنل Admin متابیس دسترسی ندارید، باید از شخصی که متابیس شما را تنظیم کرده است بپرسید.

## عیب‌یابی اتصالات به سرور پایگاه داده

1. [بررسی کنید که سرور data warehouse در حال اجرا است](#checking-the-server-status).

2. بررسی کنید که آیا می‌توانید از ماشینی که متابیس را روی آن اجرا می‌کنید به data warehouse از یک کلاینت دیگر متصل شوید.

   - اگر می‌توانید از یک bastion host یا ماشین دیگر به سرور دسترسی پیدا کنید، [بررسی کنید که آیا IP address متابیس شما به سرور پایگاه داده شما دسترسی دارد](#checking-your-server-access).

   - اگر Metabase Cloud را اجرا می‌کنید، بررسی کنید که [آدرس‌های IP ما را whitelist کرده‌اید](../cloud/ip-addresses-to-whitelist.md).

3. مطمئن شوید که متابیس از نقشی با امتیازات لازم برای اتصال به data warehouse شما استفاده می‌کند. به [اعطای امتیازات پایگاه داده](../databases/users-roles-privileges.md) مراجعه کنید.

مراحل بالا به شما کمک می‌کند تشخیص دهید که آیا مشکل خارج از متابیس اتفاق می‌افتد. برای _رفع_ مشکلات با سرور پایگاه داده خود، باید به مستندات پایگاه داده یا سرویس cloud خود مراجعه کنید. به خاطر داشته باشید که [اتصال پایگاه داده خود را تست کنید](#testing-the-connection-status) بعد از اینکه تغییراتی ایجاد کردید.

اگر به سرور data warehouse دسترسی ندارید، باید از شخصی که پایگاه داده یا data warehouse شما را مدیریت می‌کند بپرسید.

## عیب‌یابی اتصالات BigQuery و Google Drive

به [عیب‌یابی اتصالات BigQuery و Google Drive](./bigquery-drive.md) مراجعه کنید

## خطاهای رایج اتصال پایگاه داده

### سؤال شما خیلی طول کشید

اگر این پیام خطا را در رابط متابیس می‌بینید، به [عیب‌یابی timeoutها](./timeout.md) بروید.

### اتصالات نمی‌توانند از پایگاه داده زیرین به دست آیند

اگر این پیام‌های خطا را در [لاگ‌ها](./server-logs.md) می‌بینید (**Admin** > **Tools** > **Logs**):

1. به **Admin** > **Databases** بروید و پایگاه داده خود را انتخاب کنید.
2. به **Advanced options** > **Additional JDBC connection string options** بروید و `trustServerCertificate=true` را اضافه کنید.
3. روی **Save** کلیک کنید.

نسخه متابیس که برای اتصال به data warehouse خود استفاده می‌کنید باید از نسخه پایگاه داده شما پشتیبانی کند. به‌عنوان مثال، نسخه‌های متابیس قدیمی‌تر از 46 از Microsoft SQL Server 2022 پشتیبانی نمی‌کنند.

## تست یک اتصال پایگاه داده

همانطور که مراحل عیب‌یابی در این راهنما را انجام می‌دهید، می‌توانید بررسی کنید که آیا هر کامپوننت طبق انتظار کار می‌کند:

- [وضعیت سرور](#checking-the-server-status)
- [دسترسی سرور](#checking-your-server-access)
- [وضعیت اتصال](#testing-the-connection-status)

### بررسی وضعیت سرور

اگر از یک سرویس پایگاه داده میزبانی‌شده استفاده می‌کنید، به کنسول بروید و وضعیت آن را تأیید کنید.

اگر دسترسی مستقیم به یک رابط command-line دارید، وارد شوید و مطمئن شوید که پایگاه داده شما در حال اجرا است و کوئری‌ها را می‌پذیرد.

### بررسی دسترسی سرور شما

برای تأیید اینکه IP address متابیس شما می‌تواند به سرور پایگاه داده دسترسی پیدا کند:

1. از دستور [netcat](https://en.wikipedia.org/wiki/Netcat) `nc` (یا معادل سیستم عامل شما) استفاده کنید تا بررسی کنید که آیا می‌توانید به host روی یک port مشخص متصل شوید. توجه داشته باشید که پایگاه‌داده‌های مختلف به‌طور پیش‌فرض از portهای متفاوتی استفاده می‌کنند.

2. اگر Metabase Cloud را اجرا می‌کنید، بررسی کنید که [آدرس‌های IP ما را whitelist کرده‌اید](../cloud/ip-addresses-to-whitelist.md).

3. بررسی کنید که اعتبارنامه‌های پایگاه داده شما صحیح هستند.

#### دستورات مثال

برای تأیید port استفاده‌شده در یک پیکربندی پیش‌فرض PostgreSQL (که روی port 5432 گوش می‌دهد):

```
nc -v your-db-host 5432
```

برای تأیید اعتبارنامه‌های شما برای یک پایگاه داده PostgreSQL (اگر نام پایگاه داده یا user/password اشتباه باشد یک خطا می‌بینید):

```
psql -h HOSTNAME -p PORT -d DATABASENAME -U DATABASEUSER
```

### تست وضعیت اتصال

1. به [ویرایشگر SQL](../questions/native-editor/writing-sql.md) متابیس بروید.
2. اتصال به پایگاه داده خود را با اجرای این تست کنید:
   ```sql
   SELECT 1
   ```

## خطای Snowflake هنگام اجرا از طریق فایل JAR

اگر به Snowflake متصل می‌شوید و با خطایی مثل `JDBC driver internal error: exception creating result` مواجه می‌شوید و از فایل JAR اجرا می‌کنید، `--add-opens java.base/java.nio=ALL-UNNAMED` را به دستور `java` خود اضافه کنید:

```
java --add-opens java.base/java.nio=ALL-UNNAMED -jar metabase.jar
```

به مستندات [اجرای فایل jar متابیس](../installation-and-operation/running-the-metabase-jar-file.md) مراجعه کنید.

## مشکلات مرتبط

- [اتصال یا کوئری من timeout می‌شود](./timeout.md).
- [پایگاه داده من کند است](./db-performance.md).

## آیا هنوز گیر کرده‌اید؟

اگر نمی‌توانید مشکل خود را با استفاده از راهنماهای عیب‌یابی حل کنید:

- در [انجمن متابیس][discourse] جستجو کنید یا بپرسید.
- برای [باگ‌ها یا محدودیت‌های شناخته شده][known-issues] جستجو کنید.
- یک [Metabase Expert](https://www.metabase.com/partners/){:target="\_blank"} استخدام کنید.

[discourse]: https://discourse.metabase.com/
[known-issues]: ./known-issues.md
